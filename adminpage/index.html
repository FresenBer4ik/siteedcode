<!DOCTYPE html>
<html lang="ru">
<head>
<link rel="icon" href="icon.png" type="image/png">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏</title>
<style>
    :root {
        --primary: #ff4242;
        --primary-dark: #e63838;
        --bg-dark: #181818;
        --bg-card: #202020;
        --bg-card-hover: #252525;
        --bg-input: #2a2a2a;
        --text-main: #f5f5f5;
        --text-secondary: #cccccc;
        --success: #27ae60;
        --warning: #f39c12;
        --danger: #e74c3c;
        --border-radius: 10px;
        --transition: all 0.3s ease;
        --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        --shadow-hover: 0 6px 16px rgba(255, 66, 66, 0.2);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: var(--bg-dark);
        color: var(--text-main);
        line-height: 1.6;
        overflow-x: hidden;
    }

    /* Header */
    header {
        background: var(--bg-card);
        border-bottom: 2px solid var(--primary);
        padding: 18px 40px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: var(--shadow);
        position: sticky;
        top: 0;
        z-index: 100;
    }

    .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
    }

    header h1 {
        font-size: 28px;
        color: var(--primary);
        font-weight: 700;
        letter-spacing: 0.5px;
    }

    .repo-btn {
        background: var(--primary);
        border: none;
        padding: 12px 24px;
        border-radius: var(--border-radius);
        color: white;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 8px;
        box-shadow: 0 2px 8px rgba(255, 66, 66, 0.3);
    }

    .repo-btn:hover {
        background: var(--primary-dark);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(255, 66, 66, 0.4);
    }

    /* Tabs */
    .tabs-container {
        background: var(--bg-card);
        margin: 0 40px;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        overflow: hidden;
    }

    .tabs {
        display: flex;
        background: #252525;
        border-bottom: 1px solid #333;
    }

    .tab {
        padding: 15px 25px;
        background: transparent;
        border: none;
        color: var(--text-secondary);
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        position: relative;
        font-size: 15px;
    }

    .tab.active {
        color: var(--primary);
        background: var(--bg-card);
    }

    .tab.active::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 3px;
        background: var(--primary);
    }

    .tab:hover:not(.active) {
        background: #2a2a2a;
        color: var(--text-main);
    }

    .tab-content {
        display: none;
        padding: 0;
    }

    .tab-content.active {
        display: block;
    }

    /* Main Layout */
    .main-container {
        display: flex;
        flex-wrap: wrap;
        gap: 24px;
        padding: 30px 40px;
        max-width: 1600px;
        margin: 0 auto;
    }

    .card {
        background: var(--bg-card);
        padding: 24px;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        transition: var(--transition);
        flex: 1;
        min-width: 300px;
    }

    .card:hover {
        box-shadow: var(--shadow-hover);
        transform: translateY(-5px);
    }

    .card h3 {
        color: var(--primary);
        margin-top: 0;
        margin-bottom: 20px;
        font-size: 20px;
        padding-bottom: 10px;
        border-bottom: 1px solid #333;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .card h3::before {
        content: "";
        display: inline-block;
        width: 4px;
        height: 20px;
        background: var(--primary);
        border-radius: 2px;
    }

    /* Form Elements */
    .form-group {
        margin-bottom: 18px;
    }

    .form-group label {
        display: block;
        margin-bottom: 6px;
        font-weight: 500;
        color: var(--text-secondary);
        font-size: 14px;
    }

    input, textarea, select {
        width: 100%;
        padding: 12px 14px;
        border-radius: var(--border-radius);
        border: none;
        outline: none;
        background: var(--bg-input);
        color: var(--text-main);
        font-size: 15px;
        transition: var(--transition);
        border: 1px solid transparent;
    }

    input:focus, textarea:focus, select:focus {
        background: #2f2f2f;
        box-shadow: 0 0 0 2px var(--primary);
        border-color: var(--primary);
    }

    textarea {
        min-height: 100px;
        resize: vertical;
    }

    .btn {
        background: var(--primary);
        border: none;
        padding: 12px 24px;
        border-radius: var(--border-radius);
        color: white;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        box-shadow: 0 2px 8px rgba(255, 66, 66, 0.3);
    }

    .btn:hover {
        background: var(--primary-dark);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(255, 66, 66, 0.4);
    }

    .btn-secondary {
        background: #3498db;
        box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
    }

    .btn-secondary:hover {
        background: #2980b9;
        box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
    }

    .btn-success {
        background: var(--success);
        box-shadow: 0 2px 8px rgba(39, 174, 96, 0.3);
    }

    .btn-success:hover {
        background: #219653;
        box-shadow: 0 4px 12px rgba(39, 174, 96, 0.4);
    }

    /* Table - –£–∂–µ –∏ –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ */
    .table-container {
        overflow-x: auto;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        margin-top: 10px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        background: var(--bg-card);
        border-radius: var(--border-radius);
        overflow: hidden;
        font-size: 14px; /* –ú–µ–Ω—å—à–∏–π —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ */
    }

    th, td {
        padding: 12px 10px; /* –ú–µ–Ω—å—à–µ –æ—Ç—Å—Ç—É–ø–æ–≤ */
        text-align: left;
        border-bottom: 1px solid #2a2a2a;
    }

    th {
        background: #252525;
        color: var(--primary);
        font-weight: 600;
        font-size: 14px;
    }

    tr {
        transition: var(--transition);
    }

    tr:last-child td {
        border-bottom: none;
    }

    tr:hover {
        background: var(--bg-card-hover);
    }

    .status-badge {
        display: inline-block;
        padding: 4px 10px; /* –ö–æ–º–ø–∞–∫—Ç–Ω–µ–µ */
        border-radius: 20px;
        font-size: 11px; /* –ú–µ–Ω—å—à–µ */
        font-weight: 600;
        text-transform: uppercase;
    }

    .status-public {
        background: rgba(39, 174, 96, 0.2);
        color: var(--success);
    }

    .status-secret {
        background: rgba(243, 156, 18, 0.2);
        color: var(--warning);
    }

    .status-game {
        background: rgba(155, 89, 182, 0.2);
        color: #9b59b6;
    }

    .action-btn {
        padding: 6px 10px; /* –ö–æ–º–ø–∞–∫—Ç–Ω–µ–µ */
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 12px; /* –ú–µ–Ω—å—à–µ */
        font-weight: 600;
        transition: var(--transition);
        display: inline-flex;
        align-items: center;
        gap: 4px;
    }

    .delete-btn {
        background: var(--danger);
        color: white;
        box-shadow: 0 2px 6px rgba(231, 76, 60, 0.3);
    }

    .delete-btn:hover {
        background: #c0392b;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(231, 76, 60, 0.4);
    }

    .preview-btn {
        background: #3498db;
        color: white;
        box-shadow: 0 2px 6px rgba(52, 152, 219, 0.3);
    }

    .preview-btn:hover {
        background: #2980b9;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(52, 152, 219, 0.4);
    }

    .action-buttons {
        display: flex;
        gap: 6px; /* –ú–µ–Ω—å—à–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∫–Ω–æ–ø–∫–∞–º–∏ */
    }

    /* JSON Output - –ë–æ–ª—å—à–µ –∏ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è */
    .json-container {
        margin-bottom: 20px;
    }

    .json-editor {
        background: var(--bg-input);
        padding: 18px;
        border-radius: var(--border-radius);
        color: #a8ff60;
        font-size: 14px;
        height: 350px; /* –ë–æ–ª—å—à–µ –≤—ã—Å–æ—Ç–∞ */
        overflow-y: auto;
        border: 1px solid #333;
        white-space: pre-wrap;
        word-wrap: break-word;
        font-family: 'Consolas', 'Monaco', monospace;
        line-height: 1.4;
        margin-bottom: 15px;
    }

    .json-editor:focus {
        outline: none;
        box-shadow: 0 0 0 2px var(--primary);
    }

    .json-buttons {
        display: flex;
        gap: 10px;
    }

    /* Modal */
    .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        z-index: 1000;
        padding: 20px;
    }

    .modal.active {
        opacity: 1;
        pointer-events: auto;
    }

    .modal-card {
        width: 420px;
        max-width: 95%;
        background: transparent;
        border-radius: var(--border-radius);
        transform: scale(0.8);
        transition: transform 0.3s ease;
        position: relative;
    }

    .modal.active .modal-card {
        transform: scale(1);
    }

    .close-btn {
        position: absolute;
        top: -15px;
        right: -15px;
        background: var(--primary);
        border: none;
        font-size: 18px;
        color: #fff;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 8px rgba(0,0,0,0.5);
        transition: var(--transition);
        z-index: 10;
    }

    .close-btn:hover {
        background: var(--primary-dark);
        transform: rotate(90deg);
    }

    /* Preview Card */
    .preview-card {
        background: var(--bg-card);
        border-radius: var(--border-radius);
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        overflow: hidden;
        font-family: inherit;
        transition: var(--transition);
    }

    .preview-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(0,0,0,0.6);
    }

    .preview-card img {
        width: 100%;
        height: 200px;
        object-fit: cover;
        border-bottom: 1px solid #333;
    }

    .preview-body {
        padding: 20px;
    }

    .preview-body h3 {
        margin: 0 0 12px;
        font-size: 22px;
        color: #fff;
        font-weight: 700;
    }

    .preview-body p {
        margin: 0 0 15px;
        color: var(--text-secondary);
        line-height: 1.5;
    }

    .tag {
        display: inline-block;
        background: #2c2c2c;
        color: var(--primary);
        border-radius: 15px;
        padding: 5px 12px;
        margin: 3px 6px 3px 0;
        font-size: 12px;
        font-weight: 500;
    }

    .play-btn {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        margin-top: 15px;
        color: var(--primary);
        font-weight: 600;
        cursor: pointer;
        text-decoration: none;
        transition: var(--transition);
        padding: 8px 0;
    }

    .play-btn:hover {
        color: #fff;
        text-shadow: 0 0 8px var(--primary);
        gap: 12px;
    }

    /* Responsive */
    @media (max-width: 1024px) {
        .main-container {
            flex-direction: column;
        }
        
        .card {
            width: 100%;
        }
    }

    @media (max-width: 768px) {
        header {
            padding: 15px 20px;
        }
        
        .main-container {
            padding: 20px;
        }
        
        .tabs-container {
            margin: 0 20px;
        }
        
        .tab {
            padding: 12px 15px;
            font-size: 14px;
        }
        
        th, td {
            padding: 10px 8px;
        }
        
        .action-buttons {
            flex-direction: column;
        }
        
        .json-buttons {
            flex-direction: column;
        }
    }

    /* Animations */
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .card, table, .btn {
        animation: fadeIn 0.5s ease forwards;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }

    ::-webkit-scrollbar-track {
        background: #1a1a1a;
    }

    ::-webkit-scrollbar-thumb {
        background: var(--primary);
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: var(--primary-dark);
    }
</style>
</head>
<body>

<header>
    <div class="header-content">
        <h1>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –ø—Ä–æ–µ–∫—Ç–æ–≤</h1>
        <button class="repo-btn" onclick="openRepo()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
            </svg>
            –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
        </button>
    </div>
</header>

<!-- –í–∫–ª–∞–¥–∫–∏ -->
<div class="tabs-container">
    <div class="tabs">
        <button class="tab active" data-tab="projects">–ü—Ä–æ–µ–∫—Ç—ã</button>
        <button class="tab" data-tab="games">–ò–≥—Ä—ã</button>
    </div>
    
    <!-- –í–∫–ª–∞–¥–∫–∞ –ü—Ä–æ–µ–∫—Ç—ã -->
    <div id="projects-tab" class="tab-content active">
        <div class="main-container">
            <div class="card">
                <h3>–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</h3>
                <div class="form-group">
                    <label for="title">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</label>
                    <input type="text" id="title" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞">
                </div>
                
                <div class="form-group">
                    <label for="url">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                    <input type="text" id="url" placeholder="https://example.com/image.jpg">
                </div>
                
                <div class="form-group">
                    <label for="tags">–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                    <input type="text" id="tags" placeholder="HTML, CSS, JavaScript">
                </div>
                
                <div class="form-group">
                    <label for="link">–°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ–µ–∫—Ç</label>
                    <input type="text" id="link" placeholder="https://example.com">
                </div>
                
                <div class="form-group">
                    <label for="access">–£—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞</label>
                    <select id="access">
                        <option value="public">–î–ª—è –≤—Å–µ—Ö</option>
                        <option value="secret">–°–µ–∫—Ä–µ—Ç–Ω—ã–π</option>
                        <option value="game">–ò–≥—Ä–∞</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="desc">–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</label>
                    <textarea id="desc" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞..."></textarea>
                </div>
                
                <button class="btn btn-success" onclick="addProject()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                    </svg>
                    –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
                </button>
            </div>

            <div class="card">
                <h3>–î–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–æ–≤ (JSON)</h3>
                <div class="json-container">
                    <div 
                        id="jsonOutput" 
                        class="json-editor" 
                        contenteditable="true"
                        oninput="updateProjectsFromJSON()"
                    >[]</div>
                </div>
                <div class="json-buttons">
                    <button class="btn btn-secondary" onclick="downloadJSON()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
                        </svg>
                        –°–∫–∞—á–∞—Ç—å JSON
                    </button>
                    <button class="btn" onclick="updateJSON()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                        </svg>
                        –û–±–Ω–æ–≤–∏—Ç—å –∏–∑ JSON
                    </button>
                </div>
            </div>
        </div>

        <div class="card" style="margin: 0 40px 40px;">
            <h3>–¢–µ–∫—É—â–∏–µ –ø—Ä–æ–µ–∫—Ç—ã</h3>
            <div class="table-container">
                <table id="projectsTable">
                    <thead>
                        <tr>
                            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                            <th>–¢–∏–ø</th>
                            <th>–¢–µ–≥–∏</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- –í–∫–ª–∞–¥–∫–∞ –ò–≥—Ä—ã -->
    <div id="games-tab" class="tab-content">
        <div class="main-container">
            <div class="card">
                <h3>–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä—É</h3>
                <div class="form-group">
                    <label for="gameTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã</label>
                    <input type="text" id="gameTitle" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã">
                </div>
                
                <div class="form-group">
                    <label for="gameUrl">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                    <input type="text" id="gameUrl" placeholder="https://example.com/game-image.jpg">
                </div>
                
                <div class="form-group">
                    <label for="gameTags">–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                    <input type="text" id="gameTags" placeholder="HTML5, JavaScript, –ò–≥—Ä–∞">
                </div>
                
                <div class="form-group">
                    <label for="gameLink">–°—Å—ã–ª–∫–∞ –Ω–∞ –∏–≥—Ä—É</label>
                    <input type="text" id="gameLink" placeholder="https://example.com/game">
                </div>
                
                <div class="form-group">
                    <label for="gameDesc">–û–ø–∏—Å–∞–Ω–∏–µ –∏–≥—Ä—ã</label>
                    <textarea id="gameDesc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∏–≥—Ä—ã, –≥–µ–π–º–ø–ª–µ–π, –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏..."></textarea>
                </div>
                
                <button class="btn btn-success" onclick="addGame()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                    </svg>
                    –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä—É
                </button>
            </div>

            <div class="card">
                <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä</h3>
                <div style="text-align: center; padding: 20px;">
                    <div style="font-size: 48px; color: var(--primary); margin-bottom: 10px;" id="gamesCount">0</div>
                    <div style="color: var(--text-secondary);">–í—Å–µ–≥–æ –∏–≥—Ä –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏</div>
                </div>
                <div style="margin-top: 20px;">
                    <h4 style="color: var(--text-secondary); margin-bottom: 15px;">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h4>
                    <button class="btn btn-secondary" onclick="showOnlyGames()" style="width: 100%; margin-bottom: 10px;">
                        –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–≥—Ä—ã
                    </button>
                    <button class="btn" onclick="exportGamesJSON()" style="width: 100%;">
                        –≠–∫—Å–ø–æ—Ä—Ç –∏–≥—Ä –≤ JSON
                    </button>
                </div>
            </div>
        </div>

        <div class="card" style="margin: 0 40px 40px;">
            <h3>–ö–æ–ª–ª–µ–∫—Ü–∏—è –∏–≥—Ä</h3>
            <div class="table-container">
                <table id="gamesTable">
                    <thead>
                        <tr>
                            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                            <th>–¢–µ–≥–∏</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Modal –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ -->
<div id="previewModal" class="modal">
  <div class="modal-card">
    <button class="close-btn" onclick="closePreview()">‚úñ</button>
    <div id="previewContent"></div>
  </div>
</div>

<script>
    let projects = [];

    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
    const githubJson = "https://raw.githubusercontent.com/FresenBer4ik/FresenBer4ik.github.io/main/projects.json";
    const repoUrl = "https://github.com/FresenBer4ik/FresenBer4ik.github.io";

    // –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª–∞–¥–æ–∫
    function initTabs() {
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.dataset.tab;
                
                // –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(tc => tc.classList.remove('active'));
                
                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ç–µ–∫—É—â—É—é –≤–∫–ª–∞–¥–∫—É
                tab.classList.add('active');
                document.getElementById(`${tabId}-tab`).classList.add('active');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏–ª–∏—Å—å –Ω–∞ –∏–≥—Ä—ã
                if (tabId === 'games') {
                    updateGamesStats();
                    renderGamesTable();
                }
            });
        });
    }

    function openRepo() { 
        window.open(repoUrl, "_blank"); 
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
    window.onload = async function() {
        initTabs();
        
        try {
            let res = await fetch(githubJson);
            if (res.ok) {
                projects = await res.json();
            } else {
                console.warn("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å GitHub:", res.status);
                let saved = localStorage.getItem("projects");
                if (saved) projects = JSON.parse(saved);
            }
        } catch (e) {
            console.error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:", e);
            let saved = localStorage.getItem("projects");
            if (saved) projects = JSON.parse(saved);
        }
        renderProjects();
        updateJSONDisplay();
        updateGamesStats();
        renderGamesTable();
    };

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
    function addProject() {
        let title = document.getElementById('title').value;
        let url = document.getElementById('url').value;
        let tags = document.getElementById('tags').value.split(',').map(t => t.trim()).filter(Boolean);
        let link = document.getElementById('link').value;
        let access = document.getElementById('access').value;
        let desc = document.getElementById('desc').value;

        if (!title) { 
            alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞"); 
            return; 
        }

        let project = { 
            title, 
            img: url,
            url: link,
            tags, 
            link, 
            access, 
            desc 
        };
        projects.push(project);
        saveLocal();
        renderProjects();
        updateJSONDisplay();
        updateGamesStats();
        renderGamesTable();

        // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
        document.getElementById('title').value = "";
        document.getElementById('url').value = "";
        document.getElementById('tags').value = "";
        document.getElementById('link').value = "";
        document.getElementById('desc').value = "";
        
        showNotification(`–ü—Ä–æ–µ–∫—Ç "${title}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!`);
    }

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä—ã (—Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)
    function addGame() {
        let title = document.getElementById('gameTitle').value;
        let url = document.getElementById('gameUrl').value;
        let tags = document.getElementById('gameTags').value.split(',').map(t => t.trim()).filter(Boolean);
        let link = document.getElementById('gameLink').value;
        let desc = document.getElementById('gameDesc').value;

        if (!title) { 
            alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã"); 
            return; 
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º —Ç–µ–≥ "–ò–≥—Ä–∞" –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
        if (!tags.includes('–ò–≥—Ä–∞') && !tags.includes('–∏–≥—Ä–∞')) {
            tags.unshift('–ò–≥—Ä–∞');
        }

        let project = { 
            title, 
            img: url,
            url: link,
            tags, 
            link, 
            access: 'game', // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç–∏–ø –¥–ª—è –∏–≥—Ä
            desc 
        };
        projects.push(project);
        saveLocal();
        renderProjects();
        updateJSONDisplay();
        updateGamesStats();
        renderGamesTable();

        // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
        document.getElementById('gameTitle').value = "";
        document.getElementById('gameUrl').value = "";
        document.getElementById('gameTags').value = "";
        document.getElementById('gameLink').value = "";
        document.getElementById('gameDesc').value = "";
        
        showNotification(`–ò–≥—Ä–∞ "${title}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!`);
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ
    function renderProjects() {
        let tableBody = document.querySelector('#projectsTable tbody');
        tableBody.innerHTML = '';
        
        projects.forEach((p, i) => {
            let row = tableBody.insertRow();
            
            // –ù–∞–∑–≤–∞–Ω–∏–µ
            let titleCell = row.insertCell(0);
            titleCell.innerText = p.title;
            
            // –¢–∏–ø
            let accessCell = row.insertCell(1);
            let accessBadge = document.createElement('span');
            accessBadge.className = `status-badge status-${p.access}`;
            
            let statusText = '';
            switch(p.access) {
                case 'public': statusText = '–ü—É–±–ª–∏—á–Ω—ã–π'; break;
                case 'secret': statusText = '–°–µ–∫—Ä–µ—Ç–Ω—ã–π'; break;
                case 'game': statusText = '–ò–≥—Ä–∞'; break;
                default: statusText = p.access;
            }
            accessBadge.innerText = statusText;
            accessCell.appendChild(accessBadge);
            
            // –¢–µ–≥–∏
            let tagsCell = row.insertCell(2);
            tagsCell.innerText = (p.tags || []).join(", ");
            
            // –î–µ–π—Å—Ç–≤–∏—è
            let actionsCell = row.insertCell(3);
            actionsCell.className = 'action-buttons';
            
            let prevBtn = document.createElement("button");
            prevBtn.innerText = "–ü—Ä–æ—Å–º–æ—Ç—Ä";
            prevBtn.className = "action-btn preview-btn";
            prevBtn.onclick = () => openPreview(p);
            actionsCell.appendChild(prevBtn);

            let delBtn = document.createElement("button");
            delBtn.innerText = "–£–¥–∞–ª–∏—Ç—å";
            delBtn.className = "action-btn delete-btn";
            delBtn.onclick = () => {
                if (confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å "${p.title}"?`)) {
                    projects.splice(i, 1);
                    saveLocal();
                    renderProjects();
                    updateJSONDisplay();
                    updateGamesStats();
                    renderGamesTable();
                    showNotification(`"${p.title}" —É–¥–∞–ª–µ–Ω`);
                }
            };
            actionsCell.appendChild(delBtn);
        });
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–≥—Ä –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ
    function renderGamesTable() {
        let tableBody = document.querySelector('#gamesTable tbody');
        tableBody.innerHTML = '';
        
        const games = projects.filter(p => p.access === 'game');
        
        if (games.length === 0) {
            let row = tableBody.insertRow();
            let cell = row.insertCell(0);
            cell.colSpan = 4;
            cell.style.textAlign = 'center';
            cell.style.padding = '40px';
            cell.style.color = 'var(--text-secondary)';
            cell.innerText = '–ò–≥—Ä—ã –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º—É –≤—ã—à–µ —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—É—é –∏–≥—Ä—É!';
            return;
        }
        
        games.forEach((p, i) => {
            // –ù–∞—Ö–æ–¥–∏–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–∞—Å—Å–∏–≤–µ
            const originalIndex = projects.findIndex(proj => proj === p);
            
            let row = tableBody.insertRow();
            
            // –ù–∞–∑–≤–∞–Ω–∏–µ
            let titleCell = row.insertCell(0);
            titleCell.innerText = p.title;
            
            // –¢–µ–≥–∏
            let tagsCell = row.insertCell(1);
            tagsCell.innerText = (p.tags || []).join(", ");
            
            // –°—Ç–∞—Ç—É—Å
            let statusCell = row.insertCell(2);
            let statusBadge = document.createElement('span');
            statusBadge.className = 'status-badge status-game';
            statusBadge.innerText = '–ê–∫—Ç–∏–≤–Ω–∞';
            statusCell.appendChild(statusBadge);
            
            // –î–µ–π—Å—Ç–≤–∏—è
            let actionsCell = row.insertCell(3);
            actionsCell.className = 'action-buttons';
            
            let playBtn = document.createElement("button");
            playBtn.innerText = "–ò–≥—Ä–∞—Ç—å";
            playBtn.className = "action-btn preview-btn";
            playBtn.onclick = () => {
                if (p.link) {
                    window.open(p.link, '_blank');
                } else {
                    openPreview(p);
                }
            };
            actionsCell.appendChild(playBtn);

            let delBtn = document.createElement("button");
            delBtn.innerText = "–£–¥–∞–ª–∏—Ç—å";
            delBtn.className = "action-btn delete-btn";
            delBtn.onclick = () => {
                if (confirm(`–£–¥–∞–ª–∏—Ç—å –∏–≥—Ä—É "${p.title}"?`)) {
                    projects.splice(originalIndex, 1);
                    saveLocal();
                    renderProjects();
                    updateJSONDisplay();
                    updateGamesStats();
                    renderGamesTable();
                    showNotification(`–ò–≥—Ä–∞ "${p.title}" —É–¥–∞–ª–µ–Ω–∞`);
                }
            };
            actionsCell.appendChild(delBtn);
        });
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä
    function updateGamesStats() {
        const gamesCount = projects.filter(p => p.access === 'game').length;
        document.getElementById('gamesCount').textContent = gamesCount;
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–≥—Ä—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ
    function showOnlyGames() {
        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É –ø—Ä–æ–µ–∫—Ç–æ–≤
        document.querySelector('.tab[data-tab="projects"]').click();
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∏–ª—å—Ç—Ä "–∏–≥—Ä—ã" –≤ —Å–µ–ª–µ–∫—Ç–æ—Ä–µ –¥–æ—Å—Ç—É–ø–∞
        document.getElementById('access').value = 'game';
        
        showNotification("–§–∏–ª—å—Ç—Ä '–ò–≥—Ä—ã' —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ —Ñ–æ—Ä–º–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤");
    }

    // –≠–∫—Å–ø–æ—Ä—Ç –∏–≥—Ä –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π JSON
    function exportGamesJSON() {
        const games = projects.filter(p => p.access === 'game');
        let data = JSON.stringify(games, null, 4);
        let blob = new Blob([data], {type:"application/json"});
        let url = URL.createObjectURL(blob);
        let a = document.createElement("a");
        a.href = url;
        a.download = "games.json";
        a.click();
        URL.revokeObjectURL(url);
        showNotification("–§–∞–π–ª games.json —Å–∫–∞—á–∞–Ω");
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ JSON display
    function updateJSONDisplay() {
        document.getElementById('jsonOutput').textContent = JSON.stringify(projects, null, 4);
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏–∑ JSON —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
    function updateProjectsFromJSON() {
        try {
            const jsonText = document.getElementById('jsonOutput').textContent;
            const parsedProjects = JSON.parse(jsonText);
            
            if (Array.isArray(parsedProjects)) {
                projects = parsedProjects;
                saveLocal();
                renderProjects();
                updateGamesStats();
                renderGamesTable();
                showNotification("–ü—Ä–æ–µ–∫—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏–∑ JSON");
            }
        } catch (e) {
            console.log("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON –ø—Ä–∏ –≤–≤–æ–¥–µ");
        }
    }

    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ JSON
    function updateJSON() {
        try {
            const jsonText = document.getElementById('jsonOutput').textContent;
            const parsedProjects = JSON.parse(jsonText);
            
            if (Array.isArray(parsedProjects)) {
                projects = parsedProjects;
                saveLocal();
                renderProjects();
                updateGamesStats();
                renderGamesTable();
                showNotification("–ü—Ä–æ–µ–∫—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏–∑ JSON");
            } else {
                showNotification("–û—à–∏–±–∫–∞: JSON –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∞—Å—Å–∏–≤", "error");
            }
        } catch (e) {
            showNotification("–û—à–∏–±–∫–∞: –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç JSON", "error");
            console.error("JSON parse error:", e);
        }
    }

    // –°–∫–∞—á–∏–≤–∞–Ω–∏–µ JSON
    function downloadJSON() {
        let data = JSON.stringify(projects, null, 4);
        let blob = new Blob([data], {type:"application/json"});
        let url = URL.createObjectURL(blob);
        let a = document.createElement("a");
        a.href = url;
        a.download = "projects.json";
        a.click();
        URL.revokeObjectURL(url);
        showNotification("–§–∞–π–ª projects.json —Å–∫–∞—á–∞–Ω");
    }

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
    function saveLocal() { 
        localStorage.setItem("projects", JSON.stringify(projects)); 
    }

    // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ä—Ç–æ—á–∫–∏
    function openPreview(p) {
        const tagsHtml = (p.tags || []).map(tag => `<span class="tag">${tag}</span>`).join(" ");
        const imageUrl = p.img || p.url || 'https://via.placeholder.com/400x200?text=No+Image';
        
        document.getElementById("previewContent").innerHTML = `
            <div class="preview-card">
                <img src="${imageUrl}" alt="${p.title || '–ü—Ä–æ–µ–∫—Ç'}" onerror="this.src='https://via.placeholder.com/400x200?text=–û—à–∏–±–∫–∞+–∑–∞–≥—Ä—É–∑–∫–∏'">
                <div class="preview-body">
                    <h3>${p.title || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</h3>
                    <p>${p.desc || "–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"}</p>
                    <div>${tagsHtml || '<span class="tag">–ù–µ—Ç —Ç–µ–≥–æ–≤</span>'}</div>
                    ${p.link ? `<a href="${p.link}" target="_blank" class="play-btn">${p.access === 'game' ? 'üéÆ –ò–≥—Ä–∞—Ç—å —Å–µ–π—á–∞—Å' : '–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–æ–µ–∫—Ç—É'} ‚û°Ô∏è</a>` : "<p style='color: #777; margin-top: 15px;'>–°—Å—ã–ª–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</p>"}
                </div>
            </div>
        `;
        document.getElementById("previewModal").classList.add("active");
    }

    function closePreview() {
        document.getElementById("previewModal").classList.remove("active");
    }

    // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    function showNotification(message, type = "success") {
        let notification = document.getElementById('notification');
        if (!notification) {
            notification = document.createElement('div');
            notification.id = 'notification';
            document.body.appendChild(notification);
        }
        
        const bgColor = type === "error" ? "var(--danger)" : "var(--success)";
        
        notification.style.cssText = `
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: ${bgColor};
            color: white;
            padding: 12px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            z-index: 1000;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            max-width: 300px;
        `;
        
        notification.textContent = message;
        notification.style.opacity = '1';
        notification.style.transform = 'translateY(0)';
        
        setTimeout(() => {
            notification.style.opacity = '0';
            notification.style.transform = 'translateY(100px)';
        }, 3000);
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –∫–∞—Ä—Ç–æ—á–∫–∏
    document.getElementById('previewModal').addEventListener('click', function(e) {
        if (e.target === this) {
            closePreview();
        }
    });
</script>

</body>
</html>
